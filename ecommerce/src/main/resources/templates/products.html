<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
    th:replace="~{layout :: html(title='Products - E-SHOP', content=~{::section})}">

<body>
    <section>
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
            <h2>All Products</h2>
            <form th:action="@{/products}" method="get" style="display: flex; gap: 0.5rem;">
                <input type="text" name="search" placeholder="Search products..." class="form-control"
                    style="width: 300px;">
                <button type="submit" class="btn btn-primary">Search</button>
            </form>
        </div>

        <div style="display: flex; gap: 2rem;">
            <!-- Sidebar Filters -->
            <aside style="width: 200px; flex-shrink: 0;">
                <h3 style="font-size: 1.1rem; margin-bottom: 1rem;">Categories</h3>
                <ul style="list-style: none; padding: 0;">
                    <li style="margin-bottom: 0.5rem;">
                        <a th:href="@{/products}" style="text-decoration: none; color: var(--text-color);">All
                            Categories</a>
                    </li>
                    <li th:each="cat : ${categories}" style="margin-bottom: 0.5rem;">
                        <a th:href="@{/products(categoryId=${cat.id})}" th:text="${cat.name}"
                            style="text-decoration: none; color: var(--text-color);">Category</a>
                    </li>
                </ul>
            </aside>

            <!-- Product Grid -->
            <div class="product-grid" style="flex: 1;">
                <div class="product-card" th:each="product : ${products}">
                    <img th:src="${product.imagePath != null ? product.imagePath : 'https://via.placeholder.com/300x200'}"
                        class="product-image">
                    <div class="product-info">
                        <h3 class="product-title" th:text="${product.name}">Product Name</h3>
                        <p class="product-price" th:text="${'₹' + product.price}">₹0.00</p>
                        <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                            <a th:href="@{/product-details(id=${product.id})}" class="btn btn-outline"
                                style="flex: 1; text-align: center;">View</a>
                            <form th:action="@{/cart/add}" method="post" style="flex: 1;">
                                <input type="hidden" name="productId" th:value="${product.id}">
                                <input type="hidden" name="quantity" value="1">
                                <button type="submit" class="btn btn-primary" style="width: 100%;">Add</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</body>

</html>